function processUniversal() 
{
  var sourceFolderId = '1yecwal_q9V1hBVaq4wdMYoc4Rrax2XMX';
  var archiveFolderId = '1cA2m-mw5xcmNCDAbTWJAP5b8LBcIpIsm';
  var sourceFolder = DriveApp.getFolderById(sourceFolderId);
  var archiveFolder = DriveApp.getFolderById(archiveFolderId);



    var masterSheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();


   var files = sourceFolder.getFiles(); //It is a FileIterator, a special object that lets you move through folder files one-by-one.

  while (files.hasNext()) //It checks whether there is another file available to process,Returns true if files are still left, else false 
  {
    var file = files.next(); //move to next file 
    var fileName = file.getName(); //get file name 
    var mimeType = file.getMimeType(); //get file type

    Logger.log("Found: " + fileName + " | Type: " + mimeType);   //logging the file. It prints a message to the execution logs.

        var dataToCopy = [];


        if (mimeType === MimeType.GOOGLE_SHEETS) 
    {
      Logger.log('Processing as Google Sheet: ' + fileName);
      try 
      {
        
        var sheet = SpreadsheetApp.openById(file.getId()).getSheets()[0];
        
        dataToCopy = sheet.getDataRange().getValues();
              } catch (e) 
      {
                Logger.log('Error reading Google Sheet ' + fileName + ': ' + e);
      }
    } 


        
    else if (mimeType.indexOf("excel") > -1 || mimeType.indexOf("spreadsheet") > -1 || fileName.toLowerCase().endsWith(".xlsx")) 
    {
      Logger.log('Processing as Excel Binary: ' + fileName); //log 
      try {
        
        var tempFileConfig = {
          name: "[TEMP] " + fileName, //What the temporary Google Sheet should be called
          mimeType: MimeType.GOOGLE_SHEETS,//Tell Google Drive: create a Google Sheet
          parents: [sourceFolderId] // put temp file in the same folder 
        };
        


        var tempFile = Drive.Files.create(tempFileConfig, file.getBlob());// this line does the magic, takes excel raw files content files.blob(),ask driver api to create a file with this raw data following the blueprint created above.
        
               var tempSheet = SpreadsheetApp.openById(tempFile.id).getSheets()[0];
        dataToCopy = tempSheet.getDataRange().getValues();  // after reading the data copy the data 
        
                DriveApp.getFileById(tempFile.id).setTrashed(true);
        
      } catch (e) 
      {
        Logger.log('Error converting Excel ' + fileName + ': ' + e);
      }
    }





     if (dataToCopy.length > 0)  // of there is some data then continue else not 
    {
      try {
        if (masterSheet.getLastRow() === 0) // check if master sheet is empty , as if it is empty , insert data from first row else after the last row where there is data.
        {
                   masterSheet.getRange(1, 1, dataToCopy.length, dataToCopy[0].length).setValues(dataToCopy);//starts from 1 row 1 column and paste the entire  dataset including all rows and all columns.

        } 
        else {
                    var dataBody = dataToCopy.slice(1);
          if (dataBody.length > 0) {
            masterSheet.getRange(masterSheet.getLastRow() + 1, 1, dataBody.length, dataBody[0].length).setValues(dataBody);
          }
        }
        

 
        file.moveTo(archiveFolder);
        Logger.log('SUCCESS: Processed and Archived ' + fileName);
        
      } catch (e)
       {
        Logger.log('Error pasting data for ' + fileName + ': ' + e);
      }
    } else 
    {
      Logger.log('Skipped ' + fileName + ': No recognizable data found or file skipped.');
    }
  }
}


